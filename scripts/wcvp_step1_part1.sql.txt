
-- =============================================================================
-- STEP 1 (Part 1/6): NAMES A - C
-- =============================================================================

-- WARNING: This clears the existing app_taxa table to ensure no duplicates.
TRUNCATE TABLE app_taxa CASCADE;

INSERT INTO app_taxa (
    wcvp_id, ipni_id, powo_id, accepted_plant_name_id, parent_plant_name_id, 
    basionym_plant_name_id, homotypic_synonym, taxon_name, taxon_authors, family, 
    genus, genus_hybrid, species, species_hybrid, infraspecies, infraspecific_rank, 
    taxon_rank, taxon_status, hybrid_formula, parenthetical_author, primary_author, 
    publication_author, replaced_synonym_author, place_of_publication, volume_and_page, 
    first_published, nomenclatural_remarks, reviewed, geographic_area, lifeform_description, 
    climate_description, source_id
)
SELECT 
    plant_name_id, ipni_id, powo_id, accepted_plant_name_id, parent_plant_name_id, 
    basionym_plant_name_id, homotypic_synonym, taxon_name, taxon_authors, family, 
    genus, genus_hybrid, species, species_hybrid, infraspecies, infraspecific_rank, 
    COALESCE(taxon_rank, 'Unranked'), taxon_status, hybrid_formula, parenthetical_author, primary_author, 
    publication_author, replaced_synonym_author, place_of_publication, volume_and_page, 
    first_published, nomenclatural_remarks, reviewed, geographic_area, lifeform_description, 
    climate_description, 1
FROM wcvp_import
WHERE taxon_name < 'D';

SELECT 'Part 1 Complete: A-C' as status, count(*) as count FROM app_taxa;
