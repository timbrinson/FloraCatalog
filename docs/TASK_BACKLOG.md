# Project Roadmap & Task Back backlog

This document tracks planned features and technical improvements to ensure continuity across development sessions.

## High Priority
- [x] **Implement Grid Display Spec:** Fix the hierarchical display of plants in tree mode by following the Grid Display Spec design.
- [x] **Load "virtual-root" Parents (Hydration):** When a virtual-root is created for parents because the user filtered on a child and the parent does exist in the DB (but not in the local results pool), trigger a fetch to replace the virtual-root with the real parent record. This is Stage 2 of the "Replace Virtuals" rule.
- [x] **Fixed Fragmentation:** Resolved the "Double Family" bug where cultivars like 'Back in Black' would split into a separate `(none)` tree. (Verified v2.27.1).
- [ ] **Implement Ingestion Engine:** Rewrite the Add Plant functionality by following the Ingestion Engine design to implement the 5-stage validation pipeline and continuing to adhere to other decisions.
- [ ] **Fix Finding Plant Details:** The Icon Button for searching for plant details doesn't function. Also the Icon is not obvious what it does. I'm not sure which of the two Icons to select but neither works. The Icon button needs a tool tip saying what it does.
- [ ] **Fix Missing Controls for Adding Plants:** [Human Note: Bulk Upload was removed as the AI rewrote the Add Plant interface after the file was corrupted where it simplified things due to many issues found when adding plants. Needs implemented again after the Ingestion Engine is implemented and ading a single plant is working smoothly.] [AI Note: Implemented AddPlantModal with AI-assisted taxonomic parsing via Gemini 3 Pro. Restored Bulk Upload capability with .txt/.csv file parsing. Integrated all "Add" operations with the Activity Panel for asynchronous tracking and background processing. Cleaned up legacy files: PlantCard.tsx, ProcessMonitor.tsx, and defaultData.ts.]
- [ ] **Traceability & Lineage Framework:** [Human Note: Source Attribution was removed as the AI rewrote the Add Plant interface after the file was corrupted where it simplified things due to many issues found when adding plants. Needs implemented again after the Ingestion Engine is implemented.] [AI Note: Implemented mandatory Source Attribution in AddPlantModal. Integrated app_data_sources registry to track "Who, What, When, and How." Manual additions now capture App Version (v2.18.0), process context, and timestamp. Locked down WCVP source from manual attribution selection. Added case-insensitive matching for lineage detection. Resolved statement timeouts in Purge utility by switching to ID-chained deletion.]

## Medium Priority
- [ ] **Fix Order for GH and SH:** Move GH before Genus. Move SH before Species.
- [ ] **Fix Legend:** It disappeared. The button is there but it doesn't do anything.
- [ ] **Fix Bolding/Dimming:** Some conditions get double dimming and should just be one level of dimming. Virtual rows should have the (none) in the column for their rank be bold and the color for their rank.
- [ ] **Fix Expand/Collapse Levels:** This functionality was developed for the older string based hierarchy and does not work with Authority (IDs) for hierarchy, other than Family level.
- [ ] **Sorting on Family:** With the new grid tree using Authority (IDs) and Family colums/rows turned on, it is not sorting by genus and adding the family abve it. Can we make it sort on Family and group all the Genus under the one instance of a particular family?
- [ ] **Create Records for Family:** We have done a lot of work to accomodate Family level when it exists as an attribute and not a record or WCVP rank. Should we create records for all Family values used in WCVP? We would add teh Family Rank as an extension (like was done for Cultivar). We would need a special Status as well like 'Generated' or Extrapulated', that is an extension of teh WCVP vales (like was done for Registered and Provisional). 
- [ ] **Fix leading X Rule:** Need to modify a display rule where we treat genus starting X as a hybrid. For example we display "Xanthisma" as "× anthisma".
- [ ] **Clean Up Zombie Scripts:** As we developed the manual and then automated installation scripts there were a lot of changes in order to get them to work. It is not clear which are still valid and which should be archoived or deleted. It would be good to maintain both path's for installation. The manual path is good for training someone to understand the steps. The automated one is best for productivity. We need to organize the long list of scripts by seting up functional and/or logical folders.
- [ ] **Save Settings:** For the Settings that have state and grid columns selected and Statuses seelcted, have ability to perist them to the DB so it remembers their setting at the next session. Also have ability to clear what was saved so it goes back to the system defaults. This could initially be a global setting for all users but in the future each user should have ability to save their own settings or to use the global settings.
- [ ] **DataGrid & Model Consistency Audit:** Perform a line-by-line audit of DataGrid.tsx and the dataService.ts mappers to identify "Hidden Regressions." Specifically: (1) Ensure all cell renderers have type-safety checks to prevent rendering objects/arrays in spans, (2) Verify that every property used in the UI matches the Data Mapping document exactly (e.g., resolving the childCount vs descendantCount naming conflict), and (3) Ensure all ReactNode casting satisfies the compiler without using any.
- [ ] **Cache Limits:** If we keep scrolling in the grid it will continue to load more and more plants. We should have a caching scheme that can expire earlier loaded plants at some point. If the user scrolls back to to the top it would recache those that expired so that from the user's perspective it is continuous.
- [ ] **Fetch During Collapsed Tree View:** When the grid is in tree view and it is collapsed to a partular level (1,2,3,etc.) where only a few plans are displayed then fetch more plants to ayt least fill the display and allow scrolling to fetch/load even more. 
- [ ] **Virtual Row for Generic  Cultivars:** Add a virtual group under Genus to hold generic cultivars. Use something like "---" or "(none)", etc. in the Species column. Not sure if they should sort before or after the other Species. Maybe do a similar thing for the Cultivars of Species, adding a fake group named "---" or "(none)" in the Infraspecies column?
- [ ] **Activity Panel Evolution:** Enhance the Task Orchestrator to support broader background operations. (1) Optimize the layout for monitoring multiple concurrent processes, (2) Implement "Task History" to allow users to review processing details and data outcomes after the fact for the duration of the current session, and (3) Implement interactive "Checkpoint" UI where the system pauses for user review before committing large-scale changes to the shared database.
- [ ] **Build Out Details Panel:** It would show all the data for the plant organized in sections. At least any sections with a lot of information is collapsable. Include origin, history, background. Include growing conditions. Include A.K.K section. Include Physical Description section. Give it an edit mode so data can be updated (for those with the correct role).
- [ ] **Inheriting from Parents:** Since lower level taxons are a specialization of the parent can they inherit certain attributes (inherited) if those attributes are not set an the child? This would not include things like status or authorship but would include climate, geography and lifeform. May want to make it clear to the user when a description is inherited (inherited) vs specific (specialized) to that taxon.
- [ ] **Redirecting to Accepted Taxon:** Need to figure out how to handle if someone searches/filters on a synonym, how to best direct them to the accepted taxa. Would be nice if it was done automatically. Would need to explain to the user since there would be a context shift. Might want to have synonyms (and other related taxa) show up as another level in the tree, below the accepted taxa. Or this could just be on the details panel.
- [ ] **A.K.A. in Details Panel:** Update the SynonymType under types.ts to be AKATypes with values to cover scientific (WCVP Accepted/Synonyms), trade names, trademarks, registered trademarks, patents, common names, Other Cultivars, misapplied, commonly misrepresented, unspecified, etc. Anchoring to scientific (WCVP) and horticultural (ICRA) standards is required. The Details Panel would have a collapsable section called "A.K.A". There would be a way to easily distinguish the AKATypes of the entries. If this taxon has an acceptedPlantNameId then the Taxon Name of it is shown with a link to that entry. If there are other plants with this acceptedPlantNameId for this plant then their Taxon Name of it is shown with a link to that entry. Include references to reputable websites. Include brief quotes about plants from reputable sources, with proper citing and references to the source. Follow guidance provided by Google AI - see document of session conversation.
- [ ] **Physical Description:**  Include as a section in the Details Panel. Include things like plant size-Height/width, growth rate, Plant shape, plant overall texture, floliage shape, foliage size, foliage texture, foliage color, variation throughout the year, Flowering period, flower color and description, description of base/rooting system- type (bulb, rhizonme, etc.), size, shape, etc. Also include special characteristics for the type of plant it is.

## Low Priority
- [ ] **Personalized Collection:** There is a need for a user to identify the subset of plants they care about (personalized collection of data) so they don't have to weed through the full set of plants every time. 
- [ ] **Garden Collection:** There is a need for a user to track their own collection of plants that tie back to recorded plant info. 
- [ ] **Index Expansion:** Add indices to all filterable columns in `app_taxa` to prevent 57014 Database Timeouts during complex grid filtering.
- [ ] **3-Tier Architecture Transition:** Move database logic to a dedicated server/API layer to support scaling beyond free-tier and browser limitations.
- [ ] **Infrastructure Maintenance:** Address the need for a paid Supabase plan as the database exceeds logical storage limits (~1.9GB currently).
- [ ] **Lifeform Multiselect Filter:** Create a multiselect filter for the lifeform_description column (which uses the Raunkiær terminology). Previous exact-match implementation (v2.18.2) proved insufficient for complex Raunkiær strings. Future implementation requires case-insensitive substring search or GIN-index support. Nice to have would be an extension to allow logical AND. Another nice to have extension would handle filtering based on logical subtypes and descritptive terms.
- [ ] **User Authentication:** Use the Supabase Authentication for end users. Turn on RLS. Use correct API Key (not anon).
- [ ] **Create Role Based Access:** Start with at least a readonly and a read/write (or admin) role. In future expand role to allow adding Cultivars and editing those that you add. Possibly this would be a role tied to particular plant types (e.g. conifers or succulents) or specific taxon layers (Acer palmatum or Hosta). Possibly another future role to add Genus, Species and Infraspecies.
- [ ] **Architect as 3 Tier App:** Makre case-insensitive matching for lineage detection. Resolved statement timeouts in Purge utility by switching to ID-chained deletion.
- [x] (Done) **How To Reset Cultivars:** (Fixed - Pending User Verification) [AI Note: Implemented split maintenance utility in SettingsModal. Added 'Purge Non-WCVP Taxa' and 'Wipe Horticultural Details' as distinct operations in dataService.ts.]
- [x] (To be replaced with new Ingestion Engine Design) **Redesigned "Add Plant" Process to Follow Hybrid Intelligence Framework:** (Phase 1 Complete - Single Plant Validation) Implemented the Hybrid Validation Pipeline in `AddPlantModal`. System now handles AI taxonomic parsing, algorithmic assembly, automatic parent-UUID binding, and synonym redirection logic. Mark as fully verified once hybrid symbol persistence is confirmed in user garden.